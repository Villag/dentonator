var Mustache=function(){var e=function(){};return e.prototype={otag:"{{",ctag:"}}",pragmas:{},buffer:[],pragmas_implemented:{"IMPLICIT-ITERATOR":!0},context:{},render:function(e,t,i,n){if(n||(this.context=t,this.buffer=[]),!this.includes("",e))return n?e:(this.send(e),void 0);e=this.render_pragmas(e);var s=this.render_section(e,t,i);return n?this.render_tags(s,t,i,n):(this.render_tags(s,t,i,n),void 0)},send:function(e){""!=e&&this.buffer.push(e)},render_pragmas:function(e){if(!this.includes("%",e))return e;var t=this,i=new RegExp(this.otag+"%([\\w-]+) ?([\\w]+=[\\w]+)?"+this.ctag);return e.replace(i,function(e,i,n){if(!t.pragmas_implemented[i])throw{message:"This implementation of mustache doesn't understand the '"+i+"' pragma"};if(t.pragmas[i]={},n){var s=n.split("=");t.pragmas[i][s[0]]=s[1]}return""})},render_partial:function(e,t,i){if(e=this.trim(e),!i||void 0===i[e])throw{message:"unknown_partial '"+e+"'"};return"object"!=typeof t[e]?this.render(i[e],t,i,!0):this.render(i[e],t[e],i,!0)},render_section:function(e,t,i){if(!this.includes("#",e)&&!this.includes("^",e))return e;var n=this,s=new RegExp(this.otag+"(\\^|\\#)\\s*(.+)\\s*"+this.ctag+"\n*([\\s\\S]+?)"+this.otag+"\\/\\s*\\2\\s*"+this.ctag+"\\s*","mg");return e.replace(s,function(e,s,r,a){var o=n.find(r,t);return"^"==s?!o||n.is_array(o)&&0===o.length?n.render(a,t,i,!0):"":"#"==s?n.is_array(o)?n.map(o,function(e){return n.render(a,n.create_context(e),i,!0)}).join(""):n.is_object(o)?n.render(a,n.create_context(o),i,!0):"function"==typeof o?o.call(t,a,function(e){return n.render(e,t,i,!0)}):o?n.render(a,t,i,!0):"":void 0})},render_tags:function(e,t,i,n){for(var s=this,r=function(){return new RegExp(s.otag+"(=|!|>|\\{|%)?([^\\/#\\^]+?)\\1?"+s.ctag+"+","g")},a=r(),o=function(e,n,o){switch(n){case"!":return"";case"=":return s.set_delimiters(o),a=r(),"";case">":return s.render_partial(o,t,i);case"{":return s.find(o,t);default:return s.escape(s.find(o,t))}},l=e.split("\n"),c=0;c<l.length;c++)l[c]=l[c].replace(a,o,this),n||this.send(l[c]);return n?l.join("\n"):void 0},set_delimiters:function(e){var t=e.split(" ");this.otag=this.escape_regex(t[0]),this.ctag=this.escape_regex(t[1])},escape_regex:function(e){if(!arguments.callee.sRE){var t=["/",".","*","+","?","|","(",")","[","]","{","}","\\"];arguments.callee.sRE=new RegExp("(\\"+t.join("|\\")+")","g")}return e.replace(arguments.callee.sRE,"\\$1")},find:function(e,t){function i(e){return e===!1||0===e||e}e=this.trim(e);var n;return i(t[e])?n=t[e]:i(this.context[e])&&(n=this.context[e]),"function"==typeof n?n.apply(t):void 0!==n?n:""},includes:function(e,t){return-1!=t.indexOf(this.otag+e)},escape:function(e){return e=String(null===e?"":e),e.replace(/&(?!\w+;)|["'<>\\]/g,function(e){switch(e){case"&":return"&amp;";case"\\":return"\\\\";case'"':return"&quot;";case"'":return"&#39;";case"<":return"&lt;";case">":return"&gt;";default:return e}})},create_context:function(e){if(this.is_object(e))return e;var t=".";this.pragmas["IMPLICIT-ITERATOR"]&&(t=this.pragmas["IMPLICIT-ITERATOR"].iterator);var i={};return i[t]=e,i},is_object:function(e){return e&&"object"==typeof e},is_array:function(e){return"[object Array]"===Object.prototype.toString.call(e)},trim:function(e){return e.replace(/^\s*|\s*$/g,"")},map:function(e,t){if("function"==typeof e.map)return e.map(t);for(var i=[],n=e.length,s=0;n>s;s++)i.push(t(e[s]));return i}},{name:"mustache.js",version:"0.3.1-dev",to_html:function(t,i,n,s){var r=new e;return s&&(r.send=s),r.render(t,i,n),s?void 0:r.buffer.join("\n")}}}();